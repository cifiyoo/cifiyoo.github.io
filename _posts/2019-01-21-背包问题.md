---
layout: post
title: '背包问题九讲 学习笔记'
date: 2019-01-21

categories: 算法
tags: DP 背包
---

[背包问题九讲]( https://github.com/tianyicui/pack)

## 1 01背包问题

### 1.1 题目

有 $N$ 件物品和一个容量为 $V$ 的背包。放入第 $i$ 件物品耗费的费用是 $C_i$ 得到的
价值是 $W_i$ 。求解将哪些物品装入背包可使价值总和最大。

### 1.2 思路

每一种物品只有一件，选择放或不放。

$F[i,v]$ 表示前 $i$ 件物品恰好放入容量为 $v$ 的背包可以获得的最大价值。

状态转移方程：$F [i, v] = max(F [i − 1, v], F [i − 1, v − C_i ] + W_i)$

- 如果不放这第 $i$ 件物品则就考虑前 $i-1$ 件物品放入容量 $v$ 的背包；
- 如果要放这第 $i$ 件物品就考虑前 $i-1$ 件物品放入容量 $v-C_i$ 的背包；

伪代码：

$F [0, 0..V ] ← 0$  
$for\ i ← 1\ to\ N$  
	$for\ v ← C_i\ to\ V$  
		$F [i, v] ← max(F [i − 1, v], F [i − 1, v − C_i ] + W_i )$  

### 1.3 优化空间复杂度

每一次计算第 $i$ 个物品时，是从第 $i-1$ 个物品递推而来的，只需每次 $v←V…0$ 来计算 $F[v]$ 即可保证计算 $F [v]$ 时 $F [v − C_i ]$ 保存的是状态 $F [i − 1, v − C_i]$ 的值。

伪代码：

$F [0, 0..V ] ← 0$  
$for\ i ← 1\ to\ N$  
	$for\ v ← V\ to\ C_i$	  
		$F [v] ← max(F [v], F [v − C_i ] + W_i )$  


抽象处理01背包的过程：


$def\ ZeroOnePack(F, C, W )$  
	$for\ v ← V\ to\ C$  
		$F [v] ← max(F [v], F [v − C] + W )$  


01背包伪代码：


$F [0..V ] ←0$  
$for\ i ← 1\ to\ N$  
	$ZeroOnePack(F, C_i , W_i )$  


### 1.4 初始化细节

我们看到的求最优解的背包问题题目中,事实上有两种不太相同的问法。有的题目要求“恰好装满背包”时的最优解,有的题目则并没有要求必须把背包装满。一种区别这两种问法的实现方法是在初始化的时候有所不同。

如果是第一种问法,要求**恰好装满背包**,那么在初始化时**除了 F [0] 为 0 ,其它F [1..V ] 均设为 −∞** ,这样就可以保证最终得到的 F [V ] 是一种恰好装满背包的最优解。

如果并**没有要求必须把背包装满,**而是只希望价格尽量大,初始化时应该**将 F [0..V ]全部设为 0** 。

这是为什么呢?可以这样理解:初始化的 F 数组事实上就是在没有任何物品可以放入背包时的合法状态。如果要求背包恰好装满,那么此时只有容量为 0 的背包可以在什么也不装且价值为 0 的情况下被“恰好装满”,其它容量的背包均没有合法的解,属于未定义的状态,应该被赋值为 -∞ 了。如果背包并非必须被装满,那么任何容量的背包都有一个合法解“什么都不装”,这个解的价值为 0 ,所以初始时状态的值也就全部为 0了。

### 1.5 一个常数优化

上面伪代码中的

$for\ i ← 1\ to\ N$  
	$for\ v ← V\ to\ C_i$  

中第二重循环的下限可以改进。它可以被优化为

$for\ i ← 1\ to\ N$  
	$for\ v ← V\ to\ max(V − Σ^N_i W_i , C_i )$  

这个优化之所以成立的原因请读者自己思考。(提示:使用二维的转移方程思考较易。)

> 思考不出来…………

### 1.6 小结

01 背包问题是最基本的背包问题,它包含了背包问题中设计状态、方程的最基本思想。另外,别的类型的背包问题往往也可以转换成 01 背包问题求解。故一定要仔细体会上面基本思路的得出方法,状态转移方程的意义,以及空间复杂度怎样被优化。



## 2 完全背包问题

### 2.1 题目

有 $N$ 种物品和一个容量为 $V$ 的背包,每种物品都有无限件可用。放入第 $i$ 种物品的费用是 $C_i$ ,价值是 $W_i$ 。求解:将哪些物品装入背包,可使这些物品的耗费的费用总和不超过背包容量,且价值总和最大。

### 2.2 基本思路

这个问题非常类似于 01 背包问题,所不同的是每种物品有无限件。也就是从每种物品的角度考虑,与它相关的策略已并非取或不取两种,而是有取 0 件、取 1 件、取 2件......直至取 $⌊V /C_i ⌋$ 件等许多种。

